define("hd:widget/hundmil/index.js", function (e, n, a) { a.exports = function () { function n(e) { var n = (e + "").length; p = n; var a = []; if (0 == m) { for (var t = 0; p > t; t++) d = $(".J_kilo").find("li").eq(0).clone(), a.push(d); var i = 80 * p; $(".J_kilo").html(a).css("width", i).parent().css("width", i) } c && (c = !1, u = 0, s(e)) } function a() { if (h) { var e = +new Date - b; e > 6e4 && !C && (C = !0, g && clearTimeout(g), clearInterval(g), T()), 6e4 > e && (C = !1); var n = parseInt(h * e + v); s(n), g && clearTimeout(g), g = setTimeout(a, 3e3) } } function t(e, n) { return function () { var t = $(".J_kilo").find("li").eq(e).find(".num-container"); t.removeClass("removeTrans"), u++, u == n && (c = !0, m++, 1 == m && (_.loadMapOver = !0, w()), f && (f = !1, g && clearTimeout(g), g = setTimeout(a, 3e3))) } } function i(e, n, a) { return function () { var i = $(".J_kilo").find("li").eq(e).find(".num-container"), s = i.find("span:lt(" + n + ")").clone(); i.find("span:lt(" + n + ")").remove(), i.append(s), i.addClass("removeTrans"), i.css("transform", "translate3d(0px, 0px, 0px)"), setTimeout(t(e, a), 50) } } function s(e) { if (J > e) setTimeout(T, 2e4), c = !0; else { if (e.toString().length > J.toString().length && J > 0) { d = $(".J_kilo").find("li").eq(0).clone(), p += 1, $(".J_kilo").prepend(d); var n = 80 * p; $(".J_kilo").css("width", n).parent().css("width", n) } J = e; var a = (e + "").length; p = a; for (var t = e.toString().split(""), s = a, r = a - 1; r >= 0; r--) { var o = parseInt(t[r]); s--; var l = $(".J_kilo").find("li").eq(s).find(".num-container"), u = 0; l.find("span").each(function () { "#" == $(this).html() && $(this).remove() }), l.find("span").each(function (e) { var n = parseInt($(this).html()); n == o && (u = e) }); var m = 97 * u; l.css("transform", "translate3d(0px, -" + m + "px, 0px)"), setTimeout(i(s, u, p), 800) } } } function r(e) { var n, a, t; for (t = e.length; t; t--) n = Math.floor(Math.random() * t), a = e[t - 1], e[t - 1] = e[n], e[n] = a; return e } var o = $(window).height(), l = ""; $(".J_loading").css("height", o); var c = !0, d = null, u = 0, p = 0, m = 0, v = 0, h = 0, f = !0, g = null, b = 0, C = !1, J = 0, _ = { loadCityOver: !1, loadLineChartOver: !1, loadMapOver: !1 }, w = function () { var e = !0; for (var n in _) _[n] || (e = !1); e && ($(".J_main").removeClass("hide"), $(".J_loading").addClass("hide"), $("body").addClass("remove-load"), $(".niu-header-c").show(), -1 != location.href.indexOf("?m") && ($(".niu-header-c, .hundmil-head, footer").hide(), $(".hundmil-main").css({ minWidth: 1400 }), $("#viewport").attr("content", "width=device-width,initial-scale=1,minimum-scale=0,maximum-scale=1,user-scalable=yes"))) }, y = document.getElementById("J_mapMain"), k = echarts.init(y), I = 0, T = function () { function a(e) { var a = e.code, i = e.data; if (200 == a) { var s = i.allmil || 1e8; s > J && (t.series[0].data = i.sml, t.series[1].data = i.mid, t.series[2].data = i.big, t.series[3].data = i.topFive, t && "object" == typeof t && k.setOption(t, !0), h = i.averageKilo || 0, 0 == h && (h = .000936781609195403), b = +new Date, v = s), n(s), M = i.nowTime } } var t = e("hd:widget/hundmil/conf/map.js"), i = parseInt(+new Date / 1e3 / 10); I++, 1 == I && (i -= 1), $.ajax({ url: l + "/hundmil/map/" + i, success: a, error: function () { setTimeout(T, 2e4), c = !0 } }) }; T(); var x = echarts.init(document.getElementById("J_mapChart")), D = 0, O = function () { var n = e("hd:widget/hundmil/conf/line.js"), a = parseInt(+new Date / 1e3 / 60); $.get(l + "/hundmil/lineData/" + a, function (e) { var a = e.code, t = e.data; if (200 == a) { var i = t.date, s = t.data; n.xAxis.data = i, n.series[0].data = s, n && "object" == typeof n && x.setOption(n, !0), D++, _.loadLineChartOver = !0, 1 == D && w(), setTimeout(O, 3e5) } }) }; O(); var M = parseInt((new Date).getTime() / 1e3), B = function () { function e() { var e = new Date(1e3 * M), t = ("0" + e.getHours()).slice(-2), i = ("0" + e.getMinutes()).slice(-2), s = ("0" + e.getSeconds()).slice(-2), r = e.getFullYear() + "/" + (e.getMonth() + 1) + "/" + e.getDate() + " " + t + ":" + i + ":" + s; if ($(".J_time").html(r), M % 10 === 0) { n = parseInt((new Date).getTime() / 1e3); var o = n - M; o != a && (M += o - a) } M++ } var n = parseInt((new Date).getTime() / 1e3), a = n - M; e(), setInterval(e, 1e3) }; B(); var L = null, j = null, R = parseInt(+new Date / 1e3 / 10); $.get(l + "/hundmil/placeOrder/" + R, function (e) { var n = e.data, a = e.code; if (200 == a) { L = n.cityForm, j = n.cityList; for (var t in j) j[t].mileage = Math.round(j[t].mileage / 1e3); var i = new IIInsomniaCityPicker({ data: L, target: "#J_changeCityBlock", valType: "k-v", hideCityInput: "#city", hideProvinceInput: "#province", callback: function (e) { F(e) } }); i.init(), H(), E(), S(), _.loadCityOver = !0, w() } }); var S = function () { var e = []; for (var n in j) { var a = j[n]; a.index = n, e.push(a) } for (var t = e.slice(3, 53), i = r(t), s = "", n = 0; 9 > n; n++) i[n] && (s += '<div class="city-unit J_cityUnit" data-id="' + i[n].index + '">' + i[n].city + "</div>"); $(".J_cityTopList").html(s) }; $("body").on("click", ".J_cityUnit", function () { var e = $(this).attr("data-id"); F(e) }); var q = function (e) { return "今日总里程：<span class='num'>" + e.mileage + "</span> KM &nbsp;&nbsp;<span class='border'>|</span>&nbsp;&nbsp; 今日骑行人数：<span class='num'>" + e.driveCount + "</span> 人&nbsp;&nbsp;<span class='border'>|</span>&nbsp;&nbsp;正在骑行人数：<span class='num'>" + e.currentDriveCount + "</span> 人" }, U = function (e) { return "<b>今日总里程</b>：<span class='num'>" + e.mileage + "</span> KM  <br><b>今日骑行人数</b>：<span class='num'>" + e.driveCount + "</span> 人<br>正在骑行人数：<span class='num'>" + e.currentDriveCount + "</span> 人" }, K = function (e) { return "今日总里程：<span class='num'>" + e.mileage + "</span> KM &nbsp;&nbsp;<span class='border'>|</span>&nbsp;&nbsp; 今日骑行人数：<span class='num'>" + e.driveCount + "</span> 人&nbsp;&nbsp;<span class='border'>|</span>&nbsp;&nbsp;正在骑行人数：<span class='num'>" + e.currentDriveCount + "</span> 人" }, F = function (e) { var n = j[e], a = parseInt(e) + 1, t = a - n.rank; $(".J_currentCityBlock").html(n.city), $(".J_currentOrder").html(a), 0 > t ? ($(".J_currentCompare").removeClass("hide"), $(".J_currentCompare").find(".sml").removeClass("down").addClass("up").html(Math.abs(t))) : 0 == t ? $(".J_currentCompare").addClass("hide") : ($(".J_currentCompare").removeClass("hide"), $(".J_currentCompare").find(".sml").removeClass("up").addClass("down").html(Math.abs(t))), $(".J_currenOrderList").html(K(n)) }, H = function () { $.getJSON("https://restapi.amap.com/v3/ip?key=54481b4d81d2abc7e4ff42a28032d2e&s=rsv3&callback=?&platform=JS&logversion=2.0&sdkversion=1.3", function (e) { var n = "北京市"; e.city && (n = e.city); var a = 0; for (var t in j) n == j[t].city && (a = t); F(a) }) }, E = function () { for (var e = 0; 3 > e; e++) { var n = j[e]; $(".J_CityTitle" + e).find("span").html(n.city), $(".J_LogBlock" + e).html(0 == e ? U(n) : q(n)) } }, N = function () { var e = $(".J_scroll").find("li").length, n = 215, a = e * n; $(".J_scroll").css("width", a); var t = 0, i = e - 5, s = function () { var e = 215 * t; 0 == t ? $(".J_navLeft").addClass("hide") : $(".J_navLeft").removeClass("hide"), t == i ? $(".J_navRight").addClass("hide") : $(".J_navRight").removeClass("hide"), $(".J_scroll").css("transform", "translate3d(-" + e + "px, 0px, 0px)") }; $(".J_navLeft").click(function () { t--, s() }), $(".J_navRight").click(function () { t++, t > i && (t = i), s() }) }; N(); var P = null, W = null, z = null; $(".J_buyerHeadBlock").find("li").each(function () { $(this).on("mouseenter", ".link-href", function () { W = $(this); var e = W.parent().attr("data-tar"); z = W.parent().attr("data-class"); var n = $(".J_buyerHeadBlock").find("li").eq(e); P = n.find(".d-" + z); var a = W.siblings(".main-descp").html(); P.html(a), P.addClass(z), W.parent().addClass("showInfo"), W.siblings(".main-img").addClass("hover") }).on("mouseleave", ".link-href", function () { P.removeClass(z), W.parent().removeClass("showInfo"), W.siblings(".main-img").removeClass("hover") }) }); var A = e("hd:widget/hundmil/map.js"); A(); var Y = function (e, n, a, t) { window.open("http://service.weibo.com/share/share.php?title=" + encodeURIComponent(e) + "&url=" + encodeURIComponent(n) + "&appkey=" + encodeURIComponent(a) + "&pic=" + encodeURIComponent(t) + "&appkey=1493905026", "_blank", "scrollbars=no,width=600,height=450,left=75,top=20,status=no,resizable=yes") }; $(".J_share").click(function () { var e = "", n = "", a = "#小牛电动一心一亿#10万牛油，275个城市，一亿公里成就达成！ 亿级里程，官网直播。磨砂黑车身象征时间>    ，金黄色拉花代表道路——一亿公里纪念版N1S，给我的旅程增添不一样的色彩。10月19日京东小牛惊喜相见！" + location.href, t = "http://hd.niu.com/static/images/hundmil.jpg"; Y(a, e, n, t) }), $(".J_leftWei").hover(function () { $(".J_codeBlock").fadeIn() }, function () { $(".J_codeBlock").fadeOut() }) } });